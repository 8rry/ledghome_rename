# PDF分割・リネームツール

dlフォルダ内のZIPファイルを処理して、PDFを分割・リネームするPythonツール

## セットアップ

### 1. 依存関係のインストール

```bash
cd python
pip install -r requirements.txt
```

### 2. 実行

```bash
python pdf_processor.py
```

## 使用方法

### 1. ZIPファイルの配置

1. 対象のZIPファイルを `dl/` フォルダに配置
2. 複数のZIPファイルがある場合は、すべて配置可能

### 2. 処理実行

```bash
python pdf_processor.py
```

3. 処理対象年月を入力（例: 2025年9月）

### 3. 結果確認

処理済みファイルは `output/` フォルダに出力されます

## 処理内容

- ZIPファイルを解凍
- 各会社のPDFファイルを処理
- `bill_shipping`ファイルを分割:
  - 1ページ目 → `{年月}_{会社名}様_ご請求書.pdf`
  - 2ページ目以降 → `{年月}_{会社名}様_ご請求明細書.pdf`
- `postage`ファイルをリネーム:
  - `{年月}_{会社名}様_ご請求送料明細書.pdf`

## フォルダ構造

```
ledghome_rename/
├── dl/                    # ダウンロードしたZIPファイル格納
│   ├── 請求書・出荷明細_2025-08-01～2025-08-31_202509031219.zip
│   └── ...
├── output/                # 処理済みファイル出力
│   ├── 202509_うきは名水株式会社様_ご請求書.pdf
│   ├── 202509_うきは名水株式会社様_ご請求明細書.pdf
│   ├── 202509_うきは名水株式会社様_ご請求送料明細書.pdf
│   └── ...
└── python/                # Python処理スクリプト
    ├── pdf_processor.py
    ├── requirements.txt
    └── README.md
```

## 出力ファイル名例

- `202509_うきは名水株式会社様_ご請求書.pdf`
- `202509_うきは名水株式会社様_ご請求明細書.pdf`
- `202509_うきは名水株式会社様_ご請求送料明細書.pdf`
- `202509_有限会社梅廼家醸造場様_ご請求書.pdf`
- `202509_有限会社梅廼家醸造場様_ご請求明細書.pdf`
- `202509_有限会社梅廼家醸造場様_ご請求送料明細書.pdf`

## 注意事項

- 処理前に `dl/` フォルダにZIPファイルを配置してください
- 処理後は `output/` フォルダのファイルをGoogle Driveに手動でアップロードしてください
- 一時ファイルは自動的に削除されます