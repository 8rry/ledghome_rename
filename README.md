# レジ（請求ファイル自動変換）RPAツール

Google Drive上のZIPファイルからPDFを抽出し、請求書・明細書・送料明細書に分割・リネームするツール

## 概要

このツールは、Google Driveに格納されたZIPファイル内のPDFファイルを処理し、統一されたファイル名で分割・リネームします。

## 新しい仕様（Python版）

### 処理フロー

1. **手動ダウンロード**: 作業者が対象ZIPファイルを `dl/` フォルダに格納
2. **Python処理**: ローカルでZIP解凍・PDF分割・リネーム
3. **手動アップロード**: 処理済みファイルをGoogle Driveにアップロード

### フォルダ構造

```
ledghome_rename/
├── dl/                    # ダウンロードしたZIPファイル格納
├── output/                # 処理済みファイル出力
├── python/                # Python処理スクリプト
└── gas/                   # GAS関連（従来版）
```

## 使用方法

### 1. セットアップ

```bash
cd python
pip install -r requirements.txt
```

### 2. ZIPファイルの配置

対象のZIPファイルを `dl/` フォルダに配置

### 3. 処理実行

```bash
python pdf_processor.py
```

### 4. 結果確認・アップロード

`output/` フォルダの処理済みファイルをGoogle Driveに手動でアップロード

## 処理内容

### 入力ファイル

- `bill_shipping_YYYYMMDDHHMMSS.pdf` - 請求書と明細書が含まれたPDF
- `postage_YYYYMMDDHHMMSS.pdf` - 送料明細書PDF

### 出力ファイル

- `{年月}_{会社名}様_ご請求書.pdf` - 請求書部分（1ページ目）
- `{年月}_{会社名}様_ご請求明細書.pdf` - 明細書部分（2ページ目以降）
- `{年月}_{会社名}様_ご請求送料明細書.pdf` - 送料明細書

## 会社名マッピング

- `ukiha017` → `うきは名水株式会社`
- `ukiha019` → `有限会社梅廼家醸造場`

## 利点

- **確実なPDF分割**: PyPDF2を使用した実際のページ分割
- **柔軟性**: ローカル環境での処理により制限が少ない
- **デバッグ容易**: ローカルでエラー確認・修正が可能
- **スケーラブル**: 複数ZIPファイルの一括処理が可能

## 従来版（GAS版）

GAS版も残してありますが、PDF分割の制限により、実際の分割は困難です。

## 注意事項

- 処理前に `dl/` フォルダにZIPファイルを配置してください
- 処理後は `output/` フォルダのファイルをGoogle Driveに手動でアップロードしてください
- 一時ファイルは自動的に削除されます