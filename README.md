# レジ（請求ファイル自動変換）RPAツール

ZIPファイルからPDFを抽出し、請求書・明細書・送料明細書に分割・リネームするPythonツール

## 概要

このツールは、ZIPファイル内のPDFファイルを処理し、送料明細書の事業者名から会社名を自動抽出して、統一されたファイル名で分割・リネームします。

## 処理フロー

1. **ZIPファイル配置**: 対象ZIPファイルを `dl/` フォルダに格納
2. **自動処理**: PythonでZIP解凍・PDF分割・リネーム
3. **結果確認**: `output/` フォルダの処理済みファイルを確認

### フォルダ構造

```
ledghome_rename/
├── dl/                    # ダウンロードしたZIPファイル格納
├── output/                # 処理済みファイル出力
├── python/                # Python処理スクリプト
│   ├── pdf_processor.py   # メイン処理スクリプト
│   ├── requirements.txt   # 依存関係
│   └── README.md          # セットアップ手順
└── README.md              # このファイル
```

## 使用方法

### 1. セットアップ

```bash
cd python
python3 -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
```

### 2. ZIPファイルの配置

対象のZIPファイルを `dl/` フォルダに配置

### 3. 処理実行

```bash
python pdf_processor.py
```

### 4. 結果確認

`output/` フォルダの処理済みファイルを確認

## 処理内容

### 入力ファイル

- `bill_shipping_YYYYMMDDHHMMSS.pdf` - 請求書と明細書が含まれたPDF
- `postage_YYYYMMDDHHMMSS.pdf` - 送料明細書PDF

### 出力ファイル

- `{年月}_{会社名}様_ご請求書.pdf` - 請求書部分（1ページ目）
- `{年月}_{会社名}様_ご請求明細書.pdf` - 明細書部分（2ページ目以降）
- `{年月}_{会社名}様_ご請求送料明細書.pdf` - 送料明細書

## 自動化機能

- **年月自動取得**: ZIPファイル名から年月を自動抽出
- **会社名自動抽出**: 送料明細書の事業者名項目から自動抽出
- **【〜】自動削除**: 会社名から【FAX】【メール】等を自動削除
- **完全自動化**: 手動入力なしで処理完了

## 利点

- **確実なPDF分割**: PyPDF2を使用した実際のページ分割
- **完全自動化**: 年月・会社名を自動取得
- **柔軟性**: ローカル環境での処理により制限が少ない
- **デバッグ容易**: ローカルでエラー確認・修正が可能
- **スケーラブル**: 複数ZIPファイルの一括処理が可能

## 注意事項

- 処理前に `dl/` フォルダにZIPファイルを配置してください
- 処理後は `output/` フォルダのファイルをGoogle Driveに手動でアップロードしてください
- 一時ファイルは自動的に削除されます